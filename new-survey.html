<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../card-display/card-display.html">
<link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-input/paper-textarea.html">
<!--
`<new-survey></new-survey>` New Survey
-->
<dom-module id="new-survey">
  <template>
    <style is="custom-style" include="iron-flex iron-flex-alignment">
      h1 {
        font-size: 30px;
      }
      paper-button {
        background: var(--accent-color);
        color: var(--button-color);
      }
      paper-material {
        background: #fff;padding: 18px;width: 260px
      }
    </style>
    <div id="surveycards" div class="layout horizontal layout-start">
        <paper-material elevation="4" style="display:inline-block">
          <paper-textarea label="Question" value="{{Question}}" char-counter maxlength="45" required auto-validate></paper-textarea>
          <center>
            <paper-input label="Option 1" value="{{One}}" char-counter maxlength="10"></paper-input>           
            <paper-input label="Option 2" value="{{Two}}" char-counter maxlength="10"></paper-input>
          </center>
        </paper-material>
        <!-- Preview of what you are tryping -->
        <card-display style="display:inline-block" cards="{{display}}" viewable></card-display>
        
      </div>
      <div class="buttons">
        <paper-button on-tap="add" raised>OK</paper-button>
        <paper-button on-tap="dontdoit" raised>Cancel</paper-button>
      </div>
    </div>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'new-survey',
    properties: {
      display: {
        computed: "getDisplay(Question, One, Two)"
      },
      One: {type: String, value: "Yes"},
      Two: {type: String, value: "No"}
    },
    getDisplay: function(Question, One, Two) {
      return [{
        data: "<center><h3 style='word-wrap: break-word; padding: 10px 10px 0 10px;'>" + Question + "</h3><paper-button raised style='margin: 5px; width: 60%;'>" + One + "</paper-button><paper-button raised style='margin: 5px; width: 60%;'>" + Two + "</paper-button></center>",
        url: "custom"
      }]
    },
    add: function() {
        // TODO readableBy other Admins
      this.fire("add-survey", {
        Question: this.Question,
        One: this.One,
        Two: this.Two,
        sharedWith: 0,
        ones: 0,
        twos: 0,
        data: "<center><h3 style='word-wrap:break-word;padding: 10px 10px 0;'>{{Question}}</h3><{{tag}} raised>{{One}}</{{tag}}><{{tag}} raised>{{Two}}</{{tag}}></center>",
        face: "<center><p style='word-wrap:break-word;padding: 10px 10px 0;'>{{Question}}</p><p>{{One}}: {{ones}}<br />{{Two}}: {{twos}}</p>", // TODO  <br /> shared with: {{sharedWith}}
        tag: "paper-button"
      })

      this.set("Question", "")
      this.set("One", "Yes")
      this.set("Two", "No")
    },
    dontdoit: function() {
      this.fire("close")
    }
  })
</script>
